{% extends 'timepiece/time-sheet/invoice/base.html' %}
{% load timepiece_tags bootstrap_toolkit %}
{% load url from future %}
{% load i18n %}

{% block title %}{% trans "Invoices" %}{% endblock %}

{% block crumbs %}
    {{ block.super }}
    <li><span class="divider">/</span> <a href="{% url 'list_invoices' %}">{% trans "Summary" %}</a></li>
{% endblock crumbs %}

{% block content %}
    <div class="row-fluid">
        <div class="span12">
            <h2>{% trans "Invoice Summary" %}</h2>
            <ul class="unstyled subnav">
                <li>
                    <a href="{% url 'invoice_projects' %}">{% trans "Create Invoice" %}</a>
                </li>
                <li>
                    {% trans "Previous Invoices" %}
                </li>
            </ul>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12">
            <form class="form-inline" accept-charset="UTF-8" method="get" action="">
                {{ search_form|as_bootstrap:"inline" }}
                <button type="submit" class="btn">{% trans "Search" %}</button>
            </form>
        </div>
    </div>

    {% load pagination_tags %}

    <div class="row-fluid">
        <div class="span12">
            {% if invoices %}
                {% autopaginate invoices %}
                {% paginate %}
                <table class="table table-bordered table-striped table-condensed">
                    <thead>
                        <tr>
                            <th>{% trans "Invoice" %}</th>
                            <th>{% trans "Reference" %}</th>
                            <th>{% trans "Project" %}</th>
                            <th>{% trans "Status" %}</th>
                            <th>{% trans "Invoiced by" %}</th>
                            <th>{% trans "Created on" %}</th>
                            <th>{% trans "Starting on" %}</th>
                            <th>{% trans "Ending on" %}</th>
                            <th>{% trans "Comments" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for invoice in invoices %}
                            <tr>
                                <td><a href="{% url 'view_invoice' invoice.pk %}">{{ invoice.pk }}</a></td>
                                <td>{{ invoice.number|default:'' }}</td>
                                <td>{{ invoice.project }}</td>
                                <td>{{ invoice.status|capfirst }}</td>
                                <td>{{ invoice.user.get_full_name }}</td>
                                <td>{{ invoice.created|date:"M d Y P" }}</td>
                                <td>{{ invoice.start|date:"M d Y" }}</td>
                                <td>{{ invoice.end|date:"M d Y" }}</td>
                                <td title="{{ invoice.comments }} ">{{ invoice.comments|truncatewords:12 }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% paginate %}
            {% else %}
                <p>{% trans "There are no invoices." %}</p>
            {% endif %}
        </div>
    </div>
{% endblock %}
